<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="/lib/bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="/js/jquery-1.11.1.js"></script>
    <script src="/lib/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>

    <script type="text/javascript">
        $(function () {
            InitTable();
            BindBtnClick();
        })

        function BindBtnClick() {
            $("#btn1").click(function () {
                var SensitiveStrs = $("#tarea").val();
                $.ajax({
                    url: "/Ashx/SensitiveAdd.ashx",
                    type: "post",
                    data: { "SensitiveStrs": SensitiveStrs },
                    success: function (data) {
                        alert('成功插入' + data + '个敏感词');
                        InitTable();
                    }
                });
            })
        }
        //获取数据显示到table中
        function InitTable(postData) {
            $.getJSON("/Ashx/SensitivePageList.ashx", postData, function (data) {
                $("#tbBody").html("");
                for (var i in data.List) {
                    var strTr = "<tr>";
                    strTr += "<td>" + data.List[i].Id + "</td>";
                    strTr += "<td>" + data.List[i].SensitiveText + "</td>";
                    strTr += "<td>" + data.List[i].Banned + "</td>";
                    strTr += "<td>" + data.List[i].Mod + "</td>";
                    strTr += "</tr>";
                    $("#tbBody").append(strTr);
                }

                $("#NavDiv").html(data.NavHtml);
                //绑定 a 标签 单击事件
                $("#NavDiv a").click(function () {
                    var href = $(this).attr("href");
                    var quertStr = href.substr(href.lastIndexOf('?') + 1);
                    InitTable(quertStr);
                    return false;
                });
            });




            //$.ajax({
            //    url: "/Ashx/SensitivePageList.ashx",
            //    type: "post",
            //    data: postData,
            //    dataType:"json",
            //    success: bindTable
            //});
            //function bindTable(data) {
            //    //$("@NavDiv").html("");
            //    //for (var i in data) {
            //    //    var tr = "<tr>";
            //    //    tr += "<td>"+dat.list[i].Id+"</td>";
            //    //    tr += "<td>" + dat.list[i].SensitiveText + "</td>";
            //    //    tr += "<td>" + dat.list[i].Banned + "</td>";
            //    //    tr += "<td>" + dat.list[i].Mod + "</td>";
            //    //    tr += "</tr>"
            //    //    $("#tbbody").append(tr);
            //    //}
            //    $("@NavDiv").html(data.NavHtml);
            //}


        }
    </script>
</head>
<body>
    <!------------------敏感词展示---------------->
    <h2>敏感词列表</h2>
    <table id="tb1" class="table table-striped table-condensed">
        <thead>
            <tr><td>编号</td><td>内容</td><td>禁用</td><td>审核</td></tr>
        </thead>
        <tbody id="tbBody"></tbody>

    </table>
    <div id="NavDiv"></div>
    <!------------------敏感词展示结束---------------->
    <!------------------敏感词添加---------------->
    <h2>敏感词添加</h2>
    <small>&nbsp;&nbsp;注意格式为:内容={BANNED} &nbsp;&nbsp;或 &nbsp;&nbsp;内容={MOD}&nbsp;&nbsp; PS:MOD为审核词,BANNED为禁用词,一行一个</small><br />
    <form id="frm1">
        <textarea id="tarea" rows="20" cols="40">
            走狗={BANNED}
            走光={MOD}
        </textarea><br />
        <input  style="width:300px" class="btn btn-lg btn-primary" type="button" value="提交" id="btn1"/>
    </form>
    <!------------------敏感词添加结束---------------->
</body>
</html>
